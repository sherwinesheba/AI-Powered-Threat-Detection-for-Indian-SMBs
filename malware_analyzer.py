from flask import request
# In app.py, add route
@app.route('/upload_malware', methods=['POST'])
def upload_malware():
    file = request.files['file']
    file_path = f"/tmp/{file.filename}"
    file.save(file_path)
    threats = analyze_malware(file_path)
    user_id = session['user_id']
    for threat in threats:
        alert_system.generate_alert(threat, user_id)
    # Policy rec
    policy = generate_report([str(threat) for threat in threats])
    return jsonify({'threats': threats, 'policy': policy})
